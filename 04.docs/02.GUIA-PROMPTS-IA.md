# Gu√≠a de Prompts para IA - Desarrollo Guiado por Especificaciones

> **Versi√≥n**: 1.0  
> **Fecha**: 2026-02-01  
> **Prop√≥sito**: Comandos y ejemplos para trabajar con IA en FallApp

---

## 1. Comandos de Contexto

### 1.1 Cargar Contexto Completo del Proyecto

```
Lee los siguientes documentos antes de empezar:
- 00.INDICE.md (√≠ndice general)
- especificaciones/00.VISION-GENERAL.md (visi√≥n del sistema)
- 01.GUIA-PROGRAMACION.md (convenciones de c√≥digo)

Luego confirma que has entendido el contexto.
```

### 1.2 Cargar Contexto de una Especificaci√≥n Espec√≠fica

```
Lee la especificaci√≥n del sistema de usuarios:
- especificaciones/01.SISTEMA-USUARIOS.md

Necesito implementar [tarea espec√≠fica] siguiendo esta especificaci√≥n.
```

### 1.3 Cargar M√∫ltiples Especificaciones Relacionadas

```
Para implementar la gesti√≥n de eventos, lee estas especificaciones en orden:
1. especificaciones/01.SISTEMA-USUARIOS.md (usuarios base)
2. especificaciones/02.FALLAS.md (fallas/casales)
3. especificaciones/03.EVENTOS.md (sistema de eventos)

Las tres especificaciones est√°n relacionadas y necesito coherencia entre ellas.
```

---

## 2. Patrones de Prompt

### 2.1 Implementar Entidad Completa desde Especificaci√≥n

```
Siguiendo la especificaci√≥n 02.FALLAS.md, implementa el m√≥dulo completo de Fallas:

Backend (Spring Boot):
- Entidad JPA: Falla.java en model/
- Repositorio: FallaRepository.java en repository/
- Servicio: FallaService.java en service/
- Controlador REST: FallaController.java en controller/
- DTOs: FallaDTO.java, CrearFallaRequest.java en dto/

Requisitos:
- Sigue las convenciones de 01.GUIA-PROGRAMACION.md
- Usa @Valid para validaciones
- Manejo de errores con excepciones personalizadas
- Logs informativos en puntos clave
```

### 2.2 Crear Migraci√≥n de Base de Datos

```
Bas√°ndote en la especificaci√≥n 03.EVENTOS.md, crea la migraci√≥n SQL:
src/main/resources/db/migration/V003__crear_tabla_eventos.sql

Incluye:
- Tabla eventos con los campos de la especificaci√≥n
- Claves for√°neas a fallas y usuarios
- √çndices para mejorar consultas (fecha, falla_id)
- Restricciones de integridad
```

### 2.3 Modificar C√≥digo Existente

```
Necesito modificar FallaController.java para a√±adir un endpoint de b√∫squeda.

Contexto:
- Lee la especificaci√≥n 02.FALLAS.md secci√≥n 4.2 (B√∫squeda)
- El endpoint debe ser GET /api/fallas/buscar?q={query}
- Buscar por nombre o direcci√≥n (insensible a may√∫sculas)
- Retornar lista de FallaDTO

Mu√©strame solo los cambios necesarios, no el archivo completo.
```

### 2.4 Crear Endpoint API Completo

```
Crea el endpoint POST /api/eventos siguiendo:
- Especificaci√≥n: 03.EVENTOS.md secci√≥n 5.1
- Patr√≥n: Sigue el estilo de FallaController

El endpoint debe:
1. Validar que el usuario autenticado es admin o casal
2. Validar que la falla existe
3. Crear el evento
4. Retornar 201 Created con EventoDTO
5. Manejar errores apropiadamente
```

### 2.5 Implementar Cliente API en Electron

```
Implementa el cliente API para Eventos en el frontend Electron:
- Archivo: src/renderer/scripts/api-eventos.js
- Funciones: listarEventos(), crearEvento(), obtenerEvento(), actualizarEvento()
- Usa async/await
- Manejo de errores con try/catch
- Incluir token de autenticaci√≥n en headers
- Mostrar notificaciones de error al usuario
```

### 2.6 Crear Repositorio Android con Room

```
Implementa EventoRepository para Android siguiendo Clean Architecture:

Contexto:
- Lee especificaciones/03.EVENTOS.md
- Usa Room para cach√© local
- Usa Retrofit para API remota
- Patr√≥n offline-first: intenta local primero, luego remota

Archivos necesarios:
- data/local/entity/EventoEntity.kt
- data/local/dao/EventoDao.kt
- data/remote/dto/EventoDto.kt
- data/repository/EventoRepositoryImpl.kt
- domain/repository/EventoRepository.kt (interfaz)
```

---

## 3. Prompts para Debugging

### 3.1 Error de Compilaci√≥n

```
Tengo el siguiente error de compilaci√≥n:
[pegar error completo]

Contexto:
- Archivo: [ruta del archivo]
- Cambios recientes: [describir qu√© se cambi√≥]

Analiza el error y prop√≥n una soluci√≥n siguiendo las convenciones del proyecto.
```

### 3.2 Error en Tiempo de Ejecuci√≥n

```
Al ejecutar [acci√≥n espec√≠fica], obtengo este error:
[pegar stacktrace completo]

Contexto:
- Endpoint/Funci√≥n: [nombre]
- Datos de entrada: [JSON o descripci√≥n]
- Comportamiento esperado: [qu√© deber√≠a pasar]

Analiza la causa ra√≠z y prop√≥n soluci√≥n.
```

### 3.3 Prueba Fallando

```
La prueba [nombre de la prueba] est√° fallando:
[pegar salida de la prueba]

Contexto:
- Archivo de prueba: [ruta]
- Funcionalidad probada: [descripci√≥n]

Analiza por qu√© falla y corrige el c√≥digo o la prueba seg√∫n corresponda.
```

---

## 4. Prompts para Pruebas

### 4.1 Crear Prueba de Integraci√≥n

```
Crea una prueba de integraci√≥n para el endpoint POST /api/eventos:

Archivo: src/test/java/com/fallapp/integration/EventoIntegrationTest.java

Escenarios a probar:
1. Crear evento con datos v√°lidos ‚Üí 201 Created
2. Crear evento sin autenticaci√≥n ‚Üí 401 Unauthorized
3. Crear evento con falla inexistente ‚Üí 404 Not Found
4. Crear evento con datos inv√°lidos ‚Üí 400 Bad Request

Usa @SpringBootTest y MockMvc.
```

### 4.2 Crear Prueba de Humo

```
Crea una prueba de humo que verifique:
1. La aplicaci√≥n arranca correctamente
2. El endpoint /api/health responde 200 OK
3. La base de datos est√° accesible
4. Los endpoints principales est√°n registrados

Archivo: src/test/java/com/fallapp/smoke/ApplicationSmokeTest.java
```

### 4.3 Crear Prueba Unitaria de Servicio

```
Crea pruebas unitarias para FallaService.crearFalla():

Archivo: src/test/java/com/fallapp/service/FallaServiceTest.java

Escenarios:
1. Crear falla con datos v√°lidos
2. Crear falla con nombre duplicado ‚Üí lanzar excepci√≥n
3. Crear falla con usuario no autorizado ‚Üí lanzar excepci√≥n

Usa Mockito para simular el repositorio.
```

---

## 5. Prompts para Refactorizaci√≥n

### 5.1 Extraer L√≥gica Repetida

```
He detectado que esta l√≥gica se repite en 3 controladores:
[pegar c√≥digo repetido]

Refactoriza creando una clase utilidad o servicio compartido.
Sugiere d√≥nde colocarla y c√≥mo usarla.
```

### 5.2 Mejorar Legibilidad

```
Este m√©todo es dif√≠cil de entender:
[pegar c√≥digo]

Refactoriza para mejorar legibilidad:
- Extraer m√©todos privados si es necesario
- Nombres de variables m√°s descriptivos
- A√±adir comentarios solo si es imprescindible
- Mantener funcionalidad id√©ntica
```

### 5.3 Optimizar Consulta

```
Esta consulta es lenta con muchos registros:
[pegar c√≥digo de repositorio o consulta]

Prop√≥n optimizaciones:
- √çndices necesarios
- Mejorar la consulta JPA/JPQL
- Paginaci√≥n si es aplicable
```

---

## 6. Prompts para Documentaci√≥n

### 6.1 Generar Documentaci√≥n de API

```
Genera la documentaci√≥n OpenAPI (Swagger) para el endpoint:
[pegar c√≥digo del controlador]

Incluye:
- Descripci√≥n del endpoint
- Par√°metros con tipos y validaciones
- Respuestas posibles con c√≥digos HTTP
- Ejemplos de request/response
```

### 6.2 Crear README de M√≥dulo

```
Crea un README.md para el m√≥dulo de [nombre del m√≥dulo]:

Incluye:
1. Descripci√≥n breve del m√≥dulo
2. Estructura de archivos
3. Dependencias externas
4. C√≥mo ejecutar/probar
5. Configuraci√≥n necesaria
```

### 6.3 Documentar Decisi√≥n T√©cnica

```
Documenta la decisi√≥n de usar [tecnolog√≠a/patr√≥n]:

Contexto: [explicar problema]
Decisi√≥n: [qu√© se decidi√≥]
Alternativas consideradas: [otras opciones]
Consecuencias: [impacto de la decisi√≥n]
```

---

## 7. Prompts para Configuraci√≥n

### 7.1 Configurar Nueva Dependencia

```
Necesito a√±adir [nombre de librer√≠a] al proyecto.

Incluye:
- Dependencia en pom.xml (Maven)
- Configuraci√≥n en application.properties si es necesario
- Clase de configuraci√≥n Spring si es necesario
- Ejemplo de uso b√°sico
```

### 7.2 Configurar Variable de Entorno

```
A√±ade una nueva variable de entorno para [prop√≥sito]:

- Nombre: [NOMBRE_VAR]
- Valor por defecto: [valor]
- D√≥nde usarla: [contexto]

Actualiza:
- application.properties
- application-dev.properties
- application-prod.properties
- README.md con documentaci√≥n
```

---

## 8. Ejemplos de Flujo Completo

### 8.1 Nueva Funcionalidad End-to-End

```
Implementa la funcionalidad completa de "Votaci√≥n de Ninots":

1. Lee la especificaci√≥n: especificaciones/04.VOTACIONES.md

2. Backend:
   - Migraci√≥n SQL: V004__crear_tabla_votos.sql
   - Entidad: Voto.java
   - Repositorio: VotoRepository.java
   - Servicio: VotoService.java
   - Controlador: VotoController.java
   - DTOs necesarios

3. Frontend Electron:
   - Cliente API: api-votos.js
   - Vista: votar.html + votar.js
   - Integrar en men√∫ principal

4. Pruebas:
   - Prueba de integraci√≥n: VotoIntegrationTest.java
   - Prueba de humo: verificar endpoint /api/votos

Implementa paso a paso, confirmando cada parte antes de continuar.
```

### 8.2 Correcci√≥n de Bug Completa

```
Bug reportado: Los usuarios pueden votar m√∫ltiples veces al mismo ninot

An√°lisis y correcci√≥n:
1. Identifica d√≥nde ocurre el problema (backend/frontend/ambos)
2. Lee la especificaci√≥n 04.VOTACIONES.md secci√≥n de restricciones
3. Prop√≥n soluci√≥n (restricci√≥n BD, validaci√≥n servicio, etc.)
4. Implementa la correcci√≥n
5. A√±ade prueba que verifique que el bug no vuelva a ocurrir
6. Verifica que no rompa funcionalidad existente
```

---

## 9. Buenas Pr√°cticas para Prompts

### ‚úÖ HACER

1. **Ser espec√≠fico**
   ```
   ‚úÖ "Crea el endpoint POST /api/fallas seg√∫n especificaciones/02.FALLAS.md secci√≥n 5.1"
   ‚ùå "Crea un endpoint para fallas"
   ```

2. **Proporcionar contexto**
   ```
   ‚úÖ "Modifica FallaService.java para a√±adir validaci√≥n de nombre duplicado.
       Lanza una DuplicateEntityException si ya existe."
   ‚ùå "A√±ade validaci√≥n de nombre"
   ```

3. **Referenciar documentaci√≥n**
   ```
   ‚úÖ "Siguiendo la convenci√≥n de 01.GUIA-PROGRAMACION.md secci√≥n 4.1"
   ‚ùå "Usa buenos nombres de variables"
   ```

4. **Indicar qu√© NO hacer**
   ```
   ‚úÖ "No uses valores por defecto silenciosos. Si falta un par√°metro, lanzar excepci√≥n."
   ```

### ‚ùå EVITAR

1. **Prompts vagos**
   - ‚ùå "Arregla esto"
   - ‚ùå "Mejora el c√≥digo"
   - ‚ùå "Optimiza"

2. **Sin contexto**
   - ‚ùå "Crea una API REST" (¬øpara qu√©? ¬øc√≥mo?)
   - ‚ùå "A√±ade una tabla" (¬øqu√© campos? ¬ørelaciones?)

3. **Asumir conocimiento impl√≠cito**
   - ‚ùå "Usa el patr√≥n habitual" (¬øcu√°l es el patr√≥n del proyecto?)

---

## 10. Checklist para Prompts Efectivos

Antes de enviar un prompt, verifica:

- [ ] He especificado qu√© archivos leer para contexto
- [ ] He indicado la especificaci√≥n relevante
- [ ] He dado ejemplos concretos si es necesario
- [ ] He mencionado las convenciones a seguir
- [ ] He indicado c√≥mo manejar errores
- [ ] He especificado qu√© archivos crear/modificar
- [ ] He indicado si necesito ver todo el c√≥digo o solo cambios

---

## 11. Plantillas de Prompts R√°pidos

### Plantilla: Implementar Entidad

```
Implementa la entidad [NOMBRE] siguiendo especificaciones/[NUMERO].NOMBRE.md:

Backend Spring Boot:
- Entidad JPA: [Nombre].java
- Repositorio: [Nombre]Repository.java  
- Servicio: [Nombre]Service.java
- Controlador: [Nombre]Controller.java
- DTOs: [Nombre]DTO.java, Crear[Nombre]Request.java

Migraci√≥n SQL: V[NUM]__crear_tabla_[nombre_plural].sql

Sigue convenciones de 01.GUIA-PROGRAMACION.md.
```

### Plantilla: Crear Endpoint

```
Crea endpoint [METODO] /api/[recurso]/[accion]:

Especificaci√≥n: especificaciones/[NUM].[NOMBRE].md secci√≥n [X.Y]

Request: [describir]
Response: [describir]
Validaciones: [listar]
Errores posibles: [listar con c√≥digos HTTP]

Incluye prueba de integraci√≥n.
```

### Plantilla: Debugging

```
Error en [contexto]:
[stacktrace o mensaje de error]

Datos de entrada: [JSON o descripci√≥n]
Comportamiento esperado: [descripci√≥n]
Comportamiento actual: [descripci√≥n]

Archivos involucrados: [listar]

Analiza y prop√≥n soluci√≥n.
```

---

## 12. Comandos √ötiles para la IA

### Verificar Compilaci√≥n
```
Verifica que el proyecto compila sin errores:
mvn clean compile
```

### Ejecutar Pruebas
```
Ejecuta las pruebas y muestra el resultado:
mvn test
```

### Verificar Estilo de C√≥digo
```
Verifica que el c√≥digo sigue las convenciones:
mvn checkstyle:check
```

### Ver Esquema de Base de Datos
```
Muestra el esquema actual de la base de datos:
\d+ [nombre_tabla]
```

---

> üí° **Recuerda**: Un buen prompt ahorra tiempo. S√© espec√≠fico, proporciona contexto, referencia la documentaci√≥n.

---

## Actualizaci√≥n

Este documento debe actualizarse cuando:
- Se descubren nuevos patrones de prompts efectivos
- Se detectan prompts que causan confusi√≥n
- Se a√±aden nuevas funcionalidades al proyecto
- Se cambian convenciones de c√≥digo

**Responsabilidad**: Todo el equipo.
