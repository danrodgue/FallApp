# ğŸ¤– Prompt Maestro para GeneraciÃ³n de CÃ³digo con IA

> **Spec ID**: MOBILE-003  
> **VersiÃ³n**: 1.0  
> **Fecha**: 2026-02-01  
> **PropÃ³sito**: Prompts estructurados para desarrollo Spec-Driven con IA

---

## ğŸ“‹ Ãndice

1. [MetodologÃ­a Spec-Driven Development](#1-metodologÃ­a-spec-driven-development)
2. [Prompt de Contexto Inicial](#2-prompt-de-contexto-inicial)
3. [Prompts por Tipo de Tarea](#3-prompts-por-tipo-de-tarea)
4. [Prompts para Features EspecÃ­ficas](#4-prompts-para-features-especÃ­ficas)
5. [Prompts de Debugging y CorrecciÃ³n](#5-prompts-de-debugging-y-correcciÃ³n)
6. [Plantilla de DocumentaciÃ³n de Cambios](#6-plantilla-de-documentaciÃ³n-de-cambios)

---

## 1. MetodologÃ­a Spec-Driven Development

### 1.1 Principios

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SPEC-DRIVEN DEVELOPMENT FLOW                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼                            â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. SPEC â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚ 2. CODE â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚ 3. DOC  â”‚
â”‚  Write  â”‚                  â”‚ Generate â”‚                 â”‚  Update â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                            â”‚                            â”‚
     â”‚ EspecificaciÃ³n             â”‚ CÃ³digo generado            â”‚ DocumentaciÃ³n
     â”‚ detallada primero          â”‚ siguiendo spec             â”‚ actualizada
     â”‚                            â”‚                            â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚  4. ERROR   â”‚
                          â”‚  Document   â”‚
                          â”‚  & Learn    â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Reglas de Oro

1. **EspecificaciÃ³n primero**: No escribir cÃ³digo sin spec aprobada
2. **Documentar mientras desarrollas**: Cada cambio se documenta
3. **Errores son aprendizaje**: Todo error se documenta para futuras referencias
4. **Contexto es clave**: Siempre proporcionar contexto completo a la IA

---

## 2. Prompt de Contexto Inicial

### 2.1 Prompt Maestro - Cargar Contexto Completo

```markdown
# CONTEXTO DEL PROYECTO - FallApp Mobile

## Proyecto
FallApp es un sistema de gestiÃ³n de fallas valencianas. Estoy desarrollando las aplicaciones mÃ³viles Android.

## DocumentaciÃ³n a leer (en orden de prioridad):
1. `03.mobile/docs/00.ARQUITECTURA-MOBILE.md` - Arquitectura Clean Architecture
2. `03.mobile/docs/01.APP-ADMIN-SPEC.md` - Spec de app admin (si trabajo en admin)
3. `03.mobile/docs/02.APP-USER-SPEC.md` - Spec de app usuario (si trabajo en user)
4. `GUIA.API.FRONTEND.md` - Endpoints de la API REST

## Stack TecnolÃ³gico
- **Lenguaje**: Kotlin
- **UI**: Jetpack Compose + Material 3
- **Arquitectura**: Clean Architecture + MVI
- **Networking**: Ktor Client
- **Base de datos local**: Room
- **DI**: Koin
- **Async**: Coroutines + Flow
- **Mapas**: Google Maps Compose

## Convenciones de CÃ³digo
- OrganizaciÃ³n por features (cada feature tiene data/domain/presentation)
- ViewModels con StateFlow para estado
- Use Cases como clases invocables (operator fun invoke)
- Repository pattern con implementaciones offline-first
- DTOs en capa data, modelos de dominio en domain
- Mappers explÃ­citos entre capas

## API Base URL
```kotlin
const val BASE_URL = "http://35.180.21.42:8080"
```

## Estructura de Respuesta API
```json
{
  "exito": true,
  "mensaje": "...",
  "datos": { ... },
  "timestamp": "2026-02-01T18:30:00"
}
```

Confirma que has entendido el contexto antes de continuar.
```

---

## 3. Prompts por Tipo de Tarea

### 3.1 Crear Nueva Feature Completa

```markdown
# TAREA: Crear feature [NOMBRE_FEATURE]

## EspecificaciÃ³n
[Pegar secciÃ³n relevante de la spec]

## Archivos a crear
Siguiendo la estructura Clean Architecture, necesito:

### Capa Domain
- [ ] `domain/model/[Entidad].kt` - Modelo de dominio
- [ ] `domain/repository/[Entidad]Repository.kt` - Interface del repositorio
- [ ] `domain/usecase/[Accion][Entidad]UseCase.kt` - Caso de uso

### Capa Data
- [ ] `data/remote/dto/[Entidad]Dto.kt` - DTO de red
- [ ] `data/remote/[Entidad]ApiService.kt` - Servicio API
- [ ] `data/local/[Entidad]Entity.kt` - Entidad Room
- [ ] `data/local/[Entidad]Dao.kt` - DAO
- [ ] `data/mapper/[Entidad]Mapper.kt` - Mappers
- [ ] `data/repository/[Entidad]RepositoryImpl.kt` - ImplementaciÃ³n

### Capa Presentation
- [ ] `presentation/[pantalla]/[Pantalla]Screen.kt` - Composable
- [ ] `presentation/[pantalla]/[Pantalla]ViewModel.kt` - ViewModel
- [ ] `presentation/[pantalla]/[Pantalla]UiState.kt` - Estado UI

## Endpoints API a usar
[Listar endpoints de GUIA.API.FRONTEND.md]

## Requisitos adicionales
- Implementar patrÃ³n offline-first
- Usar Result wrapper para manejo de errores
- Seguir convenciones de nombrado del proyecto

Genera el cÃ³digo en el orden: Domain â†’ Data â†’ Presentation
```

### 3.2 Implementar Modelo de Dominio

```markdown
# TAREA: Crear modelo de dominio [NOMBRE]

## Contexto
Feature: [nombre_feature]
Archivo destino: `com.fallapp.[app].features.[feature].domain.model.[Nombre].kt`

## Campos requeridos (de la especificaciÃ³n)
[Listar campos con tipos]

## Reglas de negocio
[Listar validaciones o reglas]

## Requisitos
- Usar data class inmutable
- Sin dependencias de frameworks (ni Android, ni Ktor, ni Room)
- Incluir funciones de utilidad si son necesarias
- Documentar con KDoc

Genera solo el archivo de modelo de dominio.
```

### 3.3 Implementar Use Case

```markdown
# TAREA: Crear caso de uso [NOMBRE_USECASE]

## Contexto
Feature: [nombre_feature]
Archivo: `com.fallapp.[app].features.[feature].domain.usecase.[Nombre]UseCase.kt`

## DescripciÃ³n
[QuÃ© hace este caso de uso]

## Dependencias
- Repository: [NombreRepository]

## Entrada
[ParÃ¡metros de entrada]

## Salida
Flow<Result<[TipoSalida]>> o suspend fun con Result<[TipoSalida]>

## LÃ³gica de negocio
[Pasos que debe realizar]

## Ejemplo de uso esperado
```kotlin
val result = useCase(parametros)
result.collect { result ->
    when (result) {
        is Result.Success -> // manejar datos
        is Result.Error -> // manejar error
        is Result.Loading -> // mostrar loading
    }
}
```

Genera el caso de uso siguiendo el patrÃ³n de clase invocable con operator fun invoke.
```

### 3.4 Implementar Repository (Offline-First)

```markdown
# TAREA: Implementar repositorio [NOMBRE]RepositoryImpl

## Contexto
Feature: [nombre_feature]
Interface: `[Nombre]Repository` (ya existente en domain)
ImplementaciÃ³n: `com.fallapp.[app].features.[feature].data.repository.[Nombre]RepositoryImpl.kt`

## Dependencias a inyectar
- remoteDataSource: [Nombre]ApiService
- localDataSource: [Nombre]Dao
- mapper: [Nombre]Mapper
- networkMonitor: NetworkMonitor (opcional)

## Estrategia Offline-First
1. Emitir Result.Loading
2. Leer y emitir datos locales (si existen)
3. Si hay conexiÃ³n, obtener datos remotos
4. Guardar datos remotos en local
5. Emitir datos actualizados
6. Manejar errores sin bloquear si hay datos locales

## MÃ©todos a implementar
[Listar mÃ©todos del interface con su estrategia]

Genera la implementaciÃ³n completa del repositorio.
```

### 3.5 Crear Pantalla Compose

```markdown
# TAREA: Crear pantalla [NOMBRE]Screen

## Contexto
Feature: [nombre_feature]
Archivo: `com.fallapp.[app].features.[feature].presentation.[pantalla]/[Nombre]Screen.kt`

## Wireframe/Boceto
[DescripciÃ³n o ASCII art de la pantalla]

## Estado UI (UiState)
```kotlin
data class [Nombre]UiState(
    // campos del estado
)
```

## Eventos UI
```kotlin
sealed class [Nombre]UiEvent {
    // eventos de usuario
}
```

## NavegaciÃ³n
- Viene de: [pantalla origen]
- Va a: [pantalla destino] (en quÃ© casos)

## Componentes a usar
- Material 3 components
- [Listar componentes especÃ­ficos]

## Requisitos
- Observar estado con collectAsStateWithLifecycle
- Manejar estados: Loading, Error, Empty, Content
- Implementar pull-to-refresh si aplica
- Accesibilidad: contentDescription en elementos interactivos

Genera la pantalla completa con su Preview.
```

### 3.6 Crear ViewModel

```markdown
# TAREA: Crear ViewModel [NOMBRE]ViewModel

## Contexto
Feature: [nombre_feature]
Archivo: `com.fallapp.[app].features.[feature].presentation.[pantalla]/[Nombre]ViewModel.kt`

## Estado UI asociado
[Nombre]UiState (ya definido)

## Eventos UI a manejar
[Nombre]UiEvent (ya definido)

## Efectos laterales (si hay)
[Nombre]Effect - navegaciÃ³n, snackbars, etc.

## Casos de uso a inyectar
- [Listar use cases]

## LÃ³gica
- InicializaciÃ³n: [quÃ© cargar al iniciar]
- Por cada evento: [cÃ³mo manejarlo]

## Requisitos
- Usar StateFlow para estado
- Usar Channel para efectos
- Usar viewModelScope para corrutinas
- Exponer solo inmutables (StateFlow, no MutableStateFlow)

Genera el ViewModel completo.
```

---

## 4. Prompts para Features EspecÃ­ficas

### 4.1 Feature: AutenticaciÃ³n

```markdown
# TAREA: Implementar feature de autenticaciÃ³n

## EspecificaciÃ³n
Ver secciÃ³n "Feature: Auth" en 02.APP-USER-SPEC.md

## Endpoints
- POST /api/auth/login
- POST /api/auth/registro

## Modelos
- User (domain)
- AuthToken (domain)
- LoginRequestDto, LoginResponseDto (data)

## Almacenamiento seguro
- Usar EncryptedSharedPreferences para el token
- Implementar TokenManager

## Pantallas
1. LoginScreen - Email + Password + BotÃ³n login + Link registro
2. RegisterScreen - Formulario de registro

## Validaciones
- Email: formato vÃ¡lido
- Password: mÃ­nimo 6 caracteres
- Nombre: mÃ­nimo 3 caracteres

## Flujo
1. Usuario introduce credenciales
2. ViewModel llama a LoginUseCase
3. Repository hace peticiÃ³n a API
4. Si OK: guardar token, navegar a home
5. Si error: mostrar mensaje

Genera la feature completa en orden: domain â†’ data â†’ presentation
```

### 4.2 Feature: Listado de Fallas con Mapa

```markdown
# TAREA: Implementar listado y mapa de fallas

## EspecificaciÃ³n
Ver secciones "Feature: Mapa de Fallas" y "Feature: Listado de Fallas" en 02.APP-USER-SPEC.md

## Endpoints
- GET /api/fallas (paginado)
- GET /api/fallas/{id}
- GET /api/fallas/buscar?texto=X
- GET /api/fallas/cercanas?latitud=X&longitud=Y&radio=Z

## Funcionalidades
1. Lista con scroll infinito (paginaciÃ³n)
2. Mapa con marcadores
3. BÃºsqueda por texto
4. Filtro por distancia
5. Cambio entre vista lista/mapa

## Offline-First
- Cachear fallas en Room
- Mostrar datos locales primero
- Actualizar en background

## Permisos
- ACCESS_FINE_LOCATION
- ACCESS_COARSE_LOCATION

Genera en orden: modelos â†’ repository â†’ usecases â†’ screens
```

### 4.3 Feature: VotaciÃ³n de Ninots

```markdown
# TAREA: Implementar sistema de votaciÃ³n

## EspecificaciÃ³n
Ver secciÃ³n "Feature: Ninots y VotaciÃ³n" en 02.APP-USER-SPEC.md

## Endpoints
- GET /api/ninots
- GET /api/ninots/{id}
- POST /api/votos (requiere auth)
- GET /api/votos/mis-votos (requiere auth)

## Reglas de votaciÃ³n
- 3 tipos de voto: INGENIOSO, CRITICO, ARTISTICO
- Un voto por tipo por ninot
- Usuario puede votar los 3 tipos en el mismo ninot
- No se puede repetir el mismo tipo

## UI de votaciÃ³n
- Mostrar 3 botones con contadores
- Indicar si ya votÃ³ en cada tipo
- AnimaciÃ³n al votar

## Manejo de auth
- Si no autenticado: mostrar diÃ¡logo para login
- Si autenticado: permitir votar

Genera la feature de votaciÃ³n completa.
```

---

## 5. Prompts de Debugging y CorrecciÃ³n

### 5.1 Reportar Error para AnÃ¡lisis

```markdown
# ERROR EN: [componente/archivo]

## DescripciÃ³n del error
[QuÃ© estÃ¡ fallando]

## Mensaje de error
```
[Pegar error completo / stacktrace]
```

## CÃ³digo actual
```kotlin
[Pegar cÃ³digo relevante]
```

## Comportamiento esperado
[QuÃ© deberÃ­a hacer]

## Comportamiento actual
[QuÃ© estÃ¡ haciendo]

## Contexto adicional
- Feature: [nombre]
- VersiÃ³n de dependencias relevantes: [listar]
- Â¿Funciona en algÃºn caso? [sÃ­/no, cuÃ¡ndo]

## Lo que ya intentÃ©
1. [Intento 1]
2. [Intento 2]

Analiza el error, explica la causa raÃ­z y proporciona la soluciÃ³n.
```

### 5.2 Solicitar Fix con DocumentaciÃ³n

```markdown
# SOLICITUD DE FIX + DOCUMENTACIÃ“N

## Error original
[DescripciÃ³n del error]

## SoluciÃ³n aplicada
[Describir la soluciÃ³n]

## Archivos modificados
[Listar archivos]

## REQUISITO: Documenta este fix

Genera una entrada para el archivo ERRORES-SOLUCIONADOS.md con:
1. ID del error (ERR-XXX)
2. Fecha
3. DescripciÃ³n del problema
4. Causa raÃ­z
5. SoluciÃ³n aplicada
6. CÃ³digo antes/despuÃ©s
7. CÃ³mo prevenir en el futuro
```

### 5.3 Revisar y Mejorar CÃ³digo

```markdown
# REVISIÃ“N DE CÃ“DIGO

## Archivo a revisar
`[ruta/al/archivo.kt]`

## CÃ³digo actual
```kotlin
[Pegar cÃ³digo]
```

## Aspectos a revisar
- [ ] Sigue Clean Architecture
- [ ] Manejo de errores apropiado
- [ ] Naming conventions
- [ ] DocumentaciÃ³n suficiente
- [ ] Potenciales memory leaks
- [ ] Thread safety
- [ ] Testabilidad

## Contexto
[QuÃ© hace este cÃ³digo, dÃ³nde se usa]

Revisa el cÃ³digo, identifica problemas y sugiere mejoras con cÃ³digo corregido.
```

---

## 6. Plantilla de DocumentaciÃ³n de Cambios

### 6.1 Registro de Cambio

```markdown
# CAMBIO: [Breve descripciÃ³n]

## Metadata
- **Fecha**: [YYYY-MM-DD]
- **Feature**: [nombre_feature]
- **Tipo**: [NEW|FIX|REFACTOR|DOCS]
- **Spec relacionada**: [MOBILE-XXX]

## DescripciÃ³n
[QuÃ© se cambiÃ³ y por quÃ©]

## Archivos modificados
| Archivo | Cambio |
|---------|--------|
| `path/to/file.kt` | [descripciÃ³n breve] |

## Impacto
- [ ] Requiere actualizar otros archivos
- [ ] Requiere migraciÃ³n de BD
- [ ] Cambia API pÃºblica del mÃ³dulo
- [ ] Afecta a otras features

## Tests
- [ ] Tests actualizados/creados
- [ ] Tests pasan

## Notas adicionales
[InformaciÃ³n extra relevante]
```

### 6.2 Template para CHANGELOG

```markdown
## [VersiÃ³n] - YYYY-MM-DD

### Added
- [Feature] DescripciÃ³n de nueva funcionalidad (#MOBILE-XXX)

### Changed
- [Feature] DescripciÃ³n de cambio (#MOBILE-XXX)

### Fixed
- [Feature] DescripciÃ³n del fix (#ERR-XXX)

### Deprecated
- [Feature] DescripciÃ³n de lo deprecado

### Removed
- [Feature] DescripciÃ³n de lo eliminado

### Security
- [Feature] DescripciÃ³n de fix de seguridad
```

---

## ğŸ“– Ejemplo de Uso Completo

### SesiÃ³n de desarrollo tÃ­pica:

```markdown
# 1. INICIO DE SESIÃ“N - Cargar contexto
[Usar Prompt de Contexto Inicial - SecciÃ³n 2.1]

# 2. PLANIFICAR TAREA
"Voy a implementar la feature de listado de fallas. 
Lee la secciÃ³n correspondiente en 02.APP-USER-SPEC.md"

# 3. GENERAR CÃ“DIGO
[Usar prompt de Feature EspecÃ­fica - SecciÃ³n 4.2]

# 4. SI HAY ERROR
[Usar prompt de Debugging - SecciÃ³n 5.1]

# 5. DOCUMENTAR CAMBIOS
[Usar plantilla de Registro de Cambio - SecciÃ³n 6.1]

# 6. DOCUMENTAR ERRORES RESUELTOS
[Si hubo errores, documentar en 04.PLANTILLA-ERRORES.md]
```

---

## ğŸ“š Documentos Relacionados

- [00.ARQUITECTURA-MOBILE.md](00.ARQUITECTURA-MOBILE.md) - Arquitectura general
- [01.APP-ADMIN-SPEC.md](01.APP-ADMIN-SPEC.md) - EspecificaciÃ³n app admin
- [02.APP-USER-SPEC.md](02.APP-USER-SPEC.md) - EspecificaciÃ³n app usuario
- [04.PLANTILLA-ERRORES.md](04.PLANTILLA-ERRORES.md) - Registro de errores
- [../../04.docs/02.GUIA-PROMPTS-IA.md](../../04.docs/02.GUIA-PROMPTS-IA.md) - GuÃ­a general de prompts

---

> **Tip**: Copia estos prompts y personalÃ­zalos segÃºn la tarea especÃ­fica.
> Siempre proporciona el mÃ¡ximo contexto posible para mejores resultados.
