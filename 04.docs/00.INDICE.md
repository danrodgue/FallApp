# üìö Documentaci√≥n FallApp

> **√çndice maestro de documentaci√≥n t√©cnica**
> √öltima actualizaci√≥n: 2026-02-18
> Versi√≥n: 2.0.4

---

## üÜï Novedades v2.0.4 (2026-02-18)

- ‚úÖ **Bugfix IA de sentimiento** - Integraci√≥n Hugging Face corregida (router + headers)
- ‚úÖ **Correcci√≥n 403/CORS** - Preflight `OPTIONS` y rutas admin alineadas
- ‚úÖ **Ajustes Docker backend** - Context path, dialecto Hibernate y arranque estable en servidor
- ‚úÖ **Documentaci√≥n t√©cnica del incidente** - Ver bugfix detallado enlazado abajo

## üÜï Novedades v2.0.3 (2026-02-16)

- ‚úÖ **Sistema de verificaci√≥n de email** - Usuarios deben verificar email al registrarse
- ‚úÖ **Integraci√≥n Brevo (SMTP)** - Env√≠o de emails configurado y funcional
- ‚úÖ **EmailService completo** - Plantillas HTML para verificaci√≥n, bienvenida, recuperaci√≥n
- ‚úÖ **Nuevos endpoints** - `/api/auth/verificar` y `/api/auth/reenviar-verificacion`
- ‚úÖ **Migraci√≥n SQL** - Campos token_verificacion agregados a usuarios
- ‚úÖ **Documentaci√≥n Brevo** - Gu√≠as completa y r√°pida de configuraci√≥n

## üÜï Novedades v2.0.2 (2026-02-13)

- ‚úÖ **API Eventos actualizada y corregida** - Endpoints completos con filtros, tipos VARCHAR
- ‚úÖ **GUIA.API.FRONTEND.md corregida** - Documentaci√≥n de eventos alineada con implementaci√≥n
- ‚úÖ **Seguridad endpoint /api/usuarios** - Acceso p√∫blico configurado
- ‚úÖ **Registro casal con falla** - Validaci√≥n idFalla requerido para rol=casal

## üÜï Novedades v2.0.0 (2026-02-10)

- ‚úÖ **Sistema de Votaci√≥n actualizado a v4.0** - Tipos actuales, modelo optimizado
- ‚úÖ **Documentaci√≥n limpia y reorganizada** - old-docs + 99.historico, duplicados eliminados
- ‚úÖ **CHANGELOG y BREAKING-CHANGES** - Trackeo de cambios y migraciones
- ‚úÖ **Gu√≠as de Integraci√≥n** - Android y Electron con ejemplos actualizados
- ‚úÖ **[GUIA-DOCUMENTACION-IA.md](GUIA-DOCUMENTACION-IA.md)** - C√≥mo y d√≥nde documentar (NUEVO)
- ‚úÖ **[MAPA-DOCUMENTACION.md](MAPA-DOCUMENTACION.md)** - GPS completo de la documentaci√≥n (NUEVO)
- ‚úÖ **Optimizado para Spec-Driven** - Referencias cruzadas, single source of truth

---

## ü§ñ Documentos Esenciales para IAs

**IMPORTANTE**: Si eres una IA trabajando en este proyecto, lee estos documentos primero:

| Orden | Documento | Prop√≥sito |
|-------|-----------|-----------|
| 1Ô∏è‚É£ | **[MAPA-DOCUMENTACION.md](MAPA-DOCUMENTACION.md)** | üó∫Ô∏è GPS: D√≥nde est√° cada cosa |
| 2Ô∏è‚É£ | **[GUIA-DOCUMENTACION-IA.md](GUIA-DOCUMENTACION-IA.md)** | üìù C√≥mo y d√≥nde documentar |
| 3Ô∏è‚É£ | **[00.INDICE.md](00.INDICE.md)** | üìö Punto de entrada (este archivo) |
| 4Ô∏è‚É£ | **[CHANGELOG.md](CHANGELOG.md)** | üîç Cambios recientes (v0.5.8) |
| 5Ô∏è‚É£ | **[especificaciones/00.VISION-GENERAL.md](especificaciones/00.VISION-GENERAL.md)** | üéØ Visi√≥n del sistema |

---

## üéØ Lectura R√°pida para IAs

```
Para entender el proyecto completo, lee en este orden:
1. MAPA-DOCUMENTACION.md                     ‚Üí GPS de documentaci√≥n
2. especificaciones/00.VISION-GENERAL.md     ‚Üí Visi√≥n general del sistema
3. 01.GUIA-PROGRAMACION.md                   ‚Üí C√≥mo desarrollar
4. CHANGELOG.md                              ‚Üí Cambios recientes (v0.5.8)
5. especificaciones/ (relevantes)            ‚Üí Especificaciones t√©cnicas

Para documentar:
‚Üí GUIA-DOCUMENTACION-IA.md                   ‚Üí C√≥mo y d√≥nde documentar
```

**Comando sugerido para IA:**
```
Lee MAPA-DOCUMENTACION.md primero para saber d√≥nde est√° cada cosa,
luego 00.INDICE.md, CHANGELOG.md y especificaciones/00.VISION-GENERAL.md
para entender el contexto y estado actual antes de hacer cambios.
```

---

## üìñ Estructura de Documentaci√≥n

```
04.docs/
‚îú‚îÄ‚îÄ 00.INDICE.md                        ‚Üê EST√ÅS AQU√ç
‚îú‚îÄ‚îÄ CHANGELOG.md                        ‚Üê üÜï Historial de cambios
‚îú‚îÄ‚îÄ BREAKING-CHANGES.md                 ‚Üê üÜï Cambios incompatibles
‚îú‚îÄ‚îÄ 01.GUIA-PROGRAMACION.md             ‚Üê Gu√≠a principal de desarrollo
‚îú‚îÄ‚îÄ 02.GUIA-PROMPTS-IA.md               ‚Üê C√≥mo trabajar con IA
‚îú‚îÄ‚îÄ 03.CONVENCIONES-IDIOMA.md           ‚Üê Uso del espa√±ol en el proyecto
‚îÇ
‚îú‚îÄ‚îÄ especificaciones/                   ‚Üê Especificaciones t√©cnicas (Spec-Driven)
‚îÇ   ‚îú‚îÄ‚îÄ 00.VISION-GENERAL.md
‚îÇ   ‚îú‚îÄ‚îÄ 01.SISTEMA-USUARIOS.md
‚îÇ   ‚îú‚îÄ‚îÄ 02.FALLAS.md
‚îÇ   ‚îú‚îÄ‚îÄ 03.BASE-DATOS.md
‚îÇ   ‚îú‚îÄ‚îÄ 04.API-REST.md                  ‚Üê v2.0 ACTUALIZADO
‚îÇ   ‚îú‚îÄ‚îÄ 05.SISTEMA-VOTACION.md          ‚Üê v4.0 ACTUALIZADO ‚≠ê
‚îÇ   ‚îî‚îÄ‚îÄ SPEC-NINOT-SIMPLIFICADO.md
‚îÇ
‚îú‚îÄ‚îÄ arquitectura/                       ‚Üê ADRs (Architecture Decision Records)
‚îÇ   ‚îú‚îÄ‚îÄ ADR-001 a ADR-010               ‚Üê Decisiones arquitect√≥nicas
‚îÇ   ‚îî‚îÄ‚îÄ [Ver lista completa abajo]
‚îÇ
‚îú‚îÄ‚îÄ apps/                               ‚Üê üÜï Gu√≠as de integraci√≥n por plataforma
‚îÇ   ‚îú‚îÄ‚îÄ android/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ INTEGRACION-API.md          ‚Üê Gu√≠a Android (Kotlin + Ktor)
‚îÇ   ‚îî‚îÄ‚îÄ electron/
‚îÇ       ‚îî‚îÄ‚îÄ INTEGRACION-API.md          ‚Üê Gu√≠a Electron (JavaScript)
‚îÇ
‚îú‚îÄ‚îÄ despliegue/                         ‚Üê Documentaci√≥n de despliegue
‚îÇ   ‚îú‚îÄ‚îÄ GESTION-USUARIOS-BD.md
‚îÇ   ‚îî‚îÄ‚îÄ SERVICIO-SYSTEMD.md
‚îÇ
‚îî‚îÄ‚îÄ old-docs/                           ‚Üê üÜï Documentaci√≥n hist√≥rica (deprecated)
    ‚îú‚îÄ‚îÄ README.md                       ‚Üê Por qu√© est√°n aqu√≠
    ‚îú‚îÄ‚îÄ 05.SISTEMA-VOTACION-v2.0-deprecated.md
    ‚îú‚îÄ‚îÄ 04.API-REST-v1.0-deprecated.md
    ‚îî‚îÄ‚îÄ [Otras versiones antiguas]
```

---

## üìÅ Estructura del Proyecto (con prefijos num√©ricos)

```
FallApp/
‚îú‚îÄ‚îÄ 01.backend/                         ‚Üê API REST Spring Boot
‚îÇ   ‚îú‚îÄ‚îÄ src/main/java/com/fallapp/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controller/                 # Endpoints REST
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service/                    # L√≥gica de negocio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repository/                 # Acceso a datos (JPA)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ model/                      # Entidades JPA
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto/                        # DTOs para API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security/                   # JWT y Spring Security
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exception/                  # Excepciones personalizadas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/                     # Configuraciones
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ util/                       # Utilidades
‚îÇ   ‚îî‚îÄ‚îÄ pom.xml
‚îÇ
‚îú‚îÄ‚îÄ 02.desktop/                         ‚Üê Aplicaci√≥n Electron
‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îÇ       ‚îú‚îÄ‚îÄ main/                       # Proceso principal
‚îÇ       ‚îú‚îÄ‚îÄ preload/                    # Bridge IPC
‚îÇ       ‚îî‚îÄ‚îÄ renderer/                   # Frontend
‚îÇ           ‚îú‚îÄ‚îÄ controllers/            # L√≥gica MVC
‚îÇ           ‚îú‚îÄ‚îÄ services/               # Cliente API
‚îÇ           ‚îú‚îÄ‚îÄ views/                  # HTMLs
‚îÇ           ‚îú‚îÄ‚îÄ styles/                 # CSS
‚îÇ           ‚îú‚îÄ‚îÄ assets/                 # Im√°genes, iconos
‚îÇ           ‚îî‚îÄ‚îÄ utils/                  # Utilidades
‚îÇ
‚îú‚îÄ‚îÄ 03.mobile/                          ‚Üê Aplicaci√≥n Android
‚îÇ   ‚îî‚îÄ‚îÄ app/src/main/kotlin/com/fallapp/
‚îÇ       ‚îú‚îÄ‚îÄ presentation/               # UI (Compose/XML)
‚îÇ       ‚îú‚îÄ‚îÄ domain/                     # Use Cases + Models
‚îÇ       ‚îú‚îÄ‚îÄ data/                       # Repositorios + API + Room
‚îÇ       ‚îî‚îÄ‚îÄ di/                         # Inyecci√≥n de dependencias
‚îÇ
‚îú‚îÄ‚îÄ 04.docs/                            ‚Üê Documentaci√≥n ‚≠ê EST√ÅS AQU√ç
‚îÇ   ‚îú‚îÄ‚îÄ 00.INDICE.md
‚îÇ   ‚îú‚îÄ‚îÄ 01.GUIA-PROGRAMACION.md
‚îÇ   ‚îú‚îÄ‚îÄ 02.GUIA-PROMPTS-IA.md
‚îÇ   ‚îú‚îÄ‚îÄ 03.CONVENCIONES-IDIOMA.md      # ‚≠ê NUEVO
‚îÇ   ‚îî‚îÄ‚îÄ especificaciones/
‚îÇ
‚îú‚îÄ‚îÄ 05.docker/                          ‚Üê Configuraci√≥n Docker
‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.yml
‚îÇ
‚îî‚îÄ‚îÄ 06.tests/                           ‚Üê Pruebas del sistema
    ‚îú‚îÄ‚îÄ integration/
    ‚îú‚îÄ‚îÄ e2e/
    ‚îî‚îÄ‚îÄ performance/
```

---

## üìã Especificaciones T√©cnicas

| # | Documento | Versi√≥n | Estado | Descripci√≥n |
|---|-----------|---------|--------|-------------|
| 00 | [VISION-GENERAL](especificaciones/00.VISION-GENERAL.md) | 1.0 | ‚úÖ Activo | Visi√≥n general de FallApp |
| 01 | [SISTEMA-USUARIOS](especificaciones/01.SISTEMA-USUARIOS.md) | 1.0 | ‚úÖ Activo | Sistema de usuarios, roles y JWT |
| 02 | [FALLAS](especificaciones/02.FALLAS.md) | 1.0 | ‚úÖ Activo | Gesti√≥n de fallas/casales |
| 03 | [BASE-DATOS](especificaciones/03.BASE-DATOS.md) | 1.0 | ‚úÖ Activo | Esquema PostgreSQL completo |
| 04 | [API-REST](especificaciones/04.API-REST.md) | 2.0 | ‚úÖ ACTUALIZADO | Endpoints REST, v2.0 con votos actualizados |
| 05 | [SISTEMA-VOTACION](especificaciones/05.SISTEMA-VOTACION.md) | 4.0 | ‚úÖ ACTUALIZADO | **Sistema de votaci√≥n completo** ‚≠ê |

---

## üìã Gesti√≥n de Cambios (Spec-Driven)

| Documento | Prop√≥sito | Cu√°ndo Consultar |
|-----------|-----------|------------------|
| [CHANGELOG.md](CHANGELOG.md) | Historial completo de cambios | Al actualizar o revisar versiones |
| [BREAKING-CHANGES.md](BREAKING-CHANGES.md) | Cambios incompatibles detallados | **Antes de actualizar apps** |

---

## üêõ Bugfixes y Configuraciones T√©cnicas

| Fecha | Documento | Tipo | Descripci√≥n |
|-------|-----------|------|-------------|
| 2026-02-18 | [BUGFIX-2026-02-18-ia-sentimiento-huggingface.md](BUGFIX-2026-02-18-ia-sentimiento-huggingface.md) | üêõ Critical Bug | Correcci√≥n IA sentimiento (Hugging Face), 403/CORS y despliegue backend |
| 2026-02-13 | [BUGFIX-2026-02-13-persistencia-usuarios.md](BUGFIX-2026-02-13-persistencia-usuarios.md) | üêõ Critical Bug | Correcci√≥n persistencia datos usuario (direcciones) |
| 2026-02-13 | [TESTING-DASHBOARD-ACCESO-REMOTO.md](TESTING-DASHBOARD-ACCESO-REMOTO.md) | üîß Config | Configuraci√≥n acceso remoto testing dashboard |

---

## üìö Convenciones del Proyecto

| # | Documento | Descripci√≥n |
|---|-----------|-------------|
| 01 | [GUIA-PROGRAMACION](01.GUIA-PROGRAMACION.md) | Convenciones de c√≥digo y patrones |
| 02 | [GUIA-PROMPTS-IA](02.GUIA-PROMPTS-IA.md) | Trabajar con asistentes IA |
| 03 | [CONVENCIONES-IDIOMA](03.CONVENCIONES-IDIOMA.md) | Uso del espa√±ol (commits, ramas, comentarios) |

---

## üì± Gu√≠as de Integraci√≥n por Plataforma

| Plataforma | Documento | Stack | Estado |
|------------|-----------|-------|--------|
| **Android** | [apps/android/INTEGRACION-API.md](apps/android/INTEGRACION-API.md) | Kotlin + Ktor + Room | ‚úÖ v1.0 |
| **Electron** | [apps/electron/INTEGRACION-API.md](apps/electron/INTEGRACION-API.md) | JavaScript + Fetch | ‚úÖ v1.0 |

**Incluyen**:
- ‚úÖ Autenticaci√≥n JWT
- ‚úÖ Sistema de votaci√≥n v4.0 (tipos actuales)
- ‚úÖ Ejemplos de c√≥digo completos
- ‚úÖ Manejo de errores
- ‚úÖ Tests

---

## üèóÔ∏è Tecnolog√≠as del Proyecto

### Backend (API REST)
- **Framework**: Spring Boot 3.x
- **Lenguaje**: Java 17+
- **Base de datos**: PostgreSQL 15+
- **ORM**: Spring Data JPA
- **Seguridad**: Spring Security
- **Documentaci√≥n API**: OpenAPI 3.0 (Springdoc)

### Frontend Escritorio
- **Framework**: Electron
- **Tecnolog√≠a**: HTML5, CSS3, JavaScript ES6+

### Aplicaci√≥n M√≥vil
- **Plataforma**: Android
- **Lenguaje**: Kotlin
- **Arquitectura**: Clean Architecture + MVI
- **BD Local**: Room
- **Networking**: Retrofit + Ktor

### Infraestructura
- **Contenedores**: Docker + Docker Compose
- **Servidor**: AWS EC2
- **Base de datos**: PostgreSQL en contenedor Docker
- **Proxy inverso**: Nginx

---

## üöÄ Inicio R√°pido

### Para Desarrolladores Humanos
1. Lee [01.GUIA-PROGRAMACION.md](01.GUIA-PROGRAMACION.md)
2. Revisa [especificaciones/00.VISION-GENERAL.md](especificaciones/00.VISION-GENERAL.md)
3. Configura el entorno con [despliegue/configuracion-docker.md](despliegue/configuracion-docker.md)

### Para IAs
1. Carga contexto: `00.INDICE.md` + `especificaciones/00.VISION-GENERAL.md`
2. Lee [02.GUIA-PROMPTS-IA.md](02.GUIA-PROMPTS-IA.md) para patrones de trabajo
3. Consulta especificaciones relevantes seg√∫n la tarea

---

## üìù Filosof√≠a de Desarrollo

### Spec-Driven Development
> **Toda funcionalidad comienza con una especificaci√≥n.**

1. **Escribir** la especificaci√≥n t√©cnica
2. **Revisar** con el equipo
3. **Implementar** siguiendo la spec
4. **Validar** que cumple la spec

### Principios Clave
- ‚úÖ **Simplicidad sobre complejidad**
- ‚úÖ **C√≥digo expl√≠cito sobre abstracciones prematuras**
- ‚úÖ **Fail-fast**: Fallar r√°pido y claro
- ‚úÖ **Documentaci√≥n viva**: La documentaci√≥n evoluciona con el c√≥digo
- ‚úÖ **Velocidad de desarrollo**: Priorizar iteraci√≥n r√°pida

---

## üéì Contexto Acad√©mico

Este proyecto es un **Proyecto Intermodular** del ciclo DAM con:
- **Duraci√≥n**: 4 semanas (19 enero - 16 febrero 2026)
- **Metodolog√≠a**: SCRUM adaptado
- **Evaluaci√≥n**: Contenido t√©cnico (65%) + Memoria (10%) + Exposici√≥n (15%) + Trabajo en clase (10%)

### M√≥dulos Involucrados
- **ADA** (Acceso a Datos): API REST + PostgreSQL
- **PMDP** (Programaci√≥n Multimedia): Aplicaci√≥n Android
- **DI** (Dise√±o de Interfaces): Aplicaci√≥n Electron
- **IPE2** (Empleabilidad): Modelo Canvas + ODS

---

## üîÑ Actualizaci√≥n de Documentaci√≥n

Esta documentaci√≥n es un **documento vivo**. 

**Cu√°ndo actualizar**:
- Despu√©s de decisiones arquitect√≥nicas importantes
- Al a√±adir nuevas funcionalidades
- Al detectar patrones que se repiten
- Al resolver problemas complejos (documentar la soluci√≥n)

**C√≥mo actualizar**:
- Mantener la estructura coherente
- Usar ejemplos concretos
- Incluir comandos/c√≥digo cuando sea relevante
- Fecha de √∫ltima actualizaci√≥n al inicio del documento

---

## üìû Referencias √ötiles

### Documentos Esenciales (Empieza aqu√≠)
- [CHANGELOG.md](CHANGELOG.md) - **Ver cambios recientes** (v0.5.11 - 2026-02-13)
- [BREAKING-CHANGES.md](BREAKING-CHANGES.md) - **Cambios incompatibles** ‚ö†Ô∏è
- [Gu√≠a de Programaci√≥n](01.GUIA-PROGRAMACION.md) - Convenciones y patrones
- [Gu√≠a de Prompts IA](02.GUIA-PROMPTS-IA.md) - Trabajar con asistentes IA
- [Visi√≥n General](especificaciones/00.VISION-GENERAL.md) - Contexto del sistema

### Bugfixes y Configuraciones Recientes (2026-02-13)
- [BUGFIX-2026-02-13-persistencia-usuarios.md](BUGFIX-2026-02-13-persistencia-usuarios.md) - üêõ Datos usuario desaparec√≠an
- [TESTING-DASHBOARD-ACCESO-REMOTO.md](TESTING-DASHBOARD-ACCESO-REMOTO.md) - üîß Acceso remoto dashboard

### Especificaciones T√©cnicas
- [Sistema de Votaci√≥n v4.0](especificaciones/05.SISTEMA-VOTACION.md) - **Actualizado 2026-02-10** ‚≠ê
- [API REST v2.0](especificaciones/04.API-REST.md) - Endpoints actualizados
- [Base de Datos](especificaciones/03.BASE-DATOS.md) - Esquema PostgreSQL

### Gu√≠as de Integraci√≥n
- [Android](apps/android/INTEGRACION-API.md) - Kotlin + Ktor
- [Electron](apps/electron/INTEGRACION-API.md) - JavaScript + Fetch

### ADRs (Decisiones Arquitect√≥nicas)
- [ADR-010](arquitectura/ADR-010-realineacion-relaciones-ninots.md) - Modelo de votos
- [ADR-008](arquitectura/ADR-008-postgresql-enum-varchar.md) - VARCHAR vs ENUM
- [Ver todos los ADRs](arquitectura/)

### Documentaci√≥n Hist√≥rica
- [old-docs/](old-docs/) - Versiones deprecated (no usar para desarrollo)

---

## ‚ö†Ô∏è Antes de Actualizar tu App

**IMPORTANTE**: Si est√°s actualizando de v0.5.0 o anterior:

1. ‚úÖ Lee [BREAKING-CHANGES.md](BREAKING-CHANGES.md) completo
2. ‚úÖ Revisa [Sistema de Votaci√≥n v4.0](especificaciones/05.SISTEMA-VOTACION.md)
3. ‚úÖ Actualiza tipos de voto: `favorito` ‚Üí `EXPERIMENTAL`, etc.
4. ‚úÖ Cambia `idNinot` por `idFalla` en votos
5. ‚úÖ Consulta gu√≠a de integraci√≥n de tu plataforma

---

> üí° **Tip para IAs**: Este documento es tu punto de partida. L√©elo primero junto con CHANGELOG.md, luego navega a las especificaciones espec√≠ficas seg√∫n la tarea a realizar.

---

**√öltima actualizaci√≥n**: 2026-02-13
**Versi√≥n**: 2.0.2
**Pr√≥xima revisi√≥n**: Tras pr√≥xima actualizaci√≥n mayor
